{% extends "base.html" %}
{% load django_bootstrap5 %}

{% block body %}

  리뷰페이지 인덱스(임시)

  <a class="btn btn-primary my-3 float-right" href="{% url 'reviews:create' %}">리뷰 쓰기</a>
  <div class="row">
    {% for review in reviews %}
      <div class="col-4 my-3">
        <div class="card">
          {% if review.img %}
            <img src="{{ review.img.url }}" class="card-img-top" alt="...">
          {% else %}
            <img src="https://dummyimage.com/1200x960/000000/c4c4c4" class="card-img-top">
          {% endif %}
          <div class="card-body">
            <h5>
              <a href="{% url 'reviews:detail' review.pk %}">{{ review.title }}</a>
            </h5>
            <p class="text-muted">{{ review.user.username }}</p>

          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  <script language="JavaScript">
    tommorow = new Date // 오늘 날짜 객체를 생성
    tommorow.setDate(tommorow.getDate() + 1) //오늘 날짜에 + 하루
    console.log(tommorow)
    hitCt = eval(cookieVal("pageHit")) // 방문 카운트 변수이며 cookieVal 함수를 실행.
    hitCt++ // 방문 카운트 +1
    document.cookie = "pageHit=" + hitCt + ";expires=" + tommorow.toGMTString() // 이곳에서 쿠키를 갱신.
    console.log(document.cookie)

    function cookieVal(cookieName) { // cookieVal 함수를 선언함.
      thisCookie = document
        .cookie
        .split("; ") // 쿠키의 문자열 구조가 '쿠키명=쿠키값; expires=유효기간' 이기 때문에 먼저 세미콜론(;)으로 나눔.(split)
      for (i = 0; i < thisCookie.length; i++) { // ; 으로 나눈 만큼 반복문을 실행. 여기서는 2번을 반복함.
        if (cookieName == thisCookie[i].split("=")[0]) { // 먼저 thisCookie[i].split("=")[0]은 '쿠키명=쿠키값' 구조에서 =으로 나눈 배열의 첫번째 값을 지칭함(쿠키명).
          return thisCookie[i].split("=")[1] // thisCookie[i].split("=")[1] 은 =으로 나눈 배열의 두번째 값.(쿠키값)
        }
      }
      return 0
    }
  </script>
  <h3 align="center">
    <script language="javascript" type="text/javascript">
      document.write("현재 홈페이지에 <font color=red>" + hitCt + "</font> 번째 방문자입니다!")
    </script>
  {% endblock body %}
